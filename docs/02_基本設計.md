# 基本設計書 - メモ帳アプリ

## 全体アーキテクチャ

### システム概要
- **アーキテクチャパターン**: フロントエンドのみのSPA（Single Page Application）
- **実行環境**: Webブラウザ
- **データ永続化**: ブラウザローカルストレージ
- **構成**: 単一HTMLファイル内にHTML、CSS、JavaScriptを統合

### システム構成図
```
┌─────────────────────────────────────┐
│            Webブラウザ                │
├─────────────────────────────────────┤
│  memo-app.html                      │
│  ├─ HTML (構造)                     │
│  ├─ CSS (スタイル)                  │
│  └─ JavaScript (ロジック)           │
├─────────────────────────────────────┤
│      ローカルストレージ               │
│  └─ memoAppTemplates (JSON)         │
└─────────────────────────────────────┘
```

## モジュール構成

### HTMLレイヤー
- **ヘッダー部**: アプリタイトル
- **サイドバー部**: テンプレート管理UI
- **メインエリア部**: メモ編集UI

### CSSレイヤー
- **レスポンシブデザイン**: Flexboxベース
- **コンポーネント単位**: ボタン、入力欄、エリア別スタイル
- **テーマ**: 単一カラーテーマ（青紫グラデーション）
- **シニア世代対応デザイン**:
  - 大きなフォントサイズ（本文16px以上、ボタン18px以上）
  - 高コントラスト比（4.5:1以上）を保つ色彩設計
  - タップターゲット最小48px四方のボタンサイズ
  - 明確な視覚的境界線とホバー効果
- **モバイルファースト設計**:
  - スマートフォン優先のレイアウト
  - タッチ操作に最適化したインタラクション
  - 画面回転に対応したフレキシブルデザイン

### JavaScriptレイヤー
```
Application Layer
├─ Event Handlers
│  ├─ saveTemplate()
│  ├─ deleteTemplate()
│  ├─ copyFromTemplate()
│  ├─ newMemo()
│  └─ clearMemo()
├─ Business Logic
│  ├─ selectTemplate()
│  ├─ loadTemplates()
│  └─ saveTemplates()
└─ UI Management
   ├─ renderTemplateList()
   ├─ updateDateInfo()
   └─ init()
```

## 外部インタフェース

### API・画面

#### データ入力
- **テンプレート名入力**: `<input type="text" id="templateName">`
- **メモ内容入力**: `<textarea id="memoText">`

#### データ出力
- **テンプレート一覧表示**: 動的生成リスト
- **日付情報表示**: 現在日時の表示
- **メモ内容表示**: テキストエリア

#### 操作インタフェース
| 操作 | UI要素 | 機能 | アクセシビリティ配慮 |
|------|--------|------|---------------------|
| テンプレート保存 | 保存ボタン | テンプレートをローカルストレージに保存 | 大きなボタン、明確なラベル |
| テンプレート削除 | 削除ボタン | 選択中テンプレートを削除 | 確認ダイアログ、警告色表示 |
| テンプレートからコピー | コピーボタン | テンプレート内容を日付付きでコピー | 分かりやすいアイコンと文字 |
| 新規メモ | 新規メモボタン | 日付のみの新規メモ作成 | プライマリーボタンとして強調 |
| メモクリア | クリアボタン | メモ内容を全消去 | 確認ダイアログ、セカンダリー扱い |

#### シニア世代向けUI配慮
- **視認性**: 高コントラスト、大きな文字サイズ
- **操作性**: 大きなタップターゲット、分かりやすいボタンラベル
- **誤操作防止**: 重要操作前の確認ダイアログ
- **フィードバック**: 操作完了時の明確な通知

### ブラウザAPI
- **LocalStorage API**: データ永続化
- **Date API**: 日付取得・フォーマット
- **DOM API**: UI操作・イベント処理

## データモデル概略

### ローカルストレージ構造
```json
{
  "memoAppTemplates": {
    "テンプレート名1": "テンプレート内容1",
    "テンプレート名2": "テンプレート内容2",
    "..."
  }
}
```

### 内部データ構造
```javascript
// テンプレート管理
let templates = {
  "会議メモ": "## 会議メモ\n\n### 参加者\n\n### 議題\n\n### 決定事項\n\n### アクションアイテム",
  "日報": "## 日報\n\n### 本日の作業内容\n\n### 課題・問題\n\n### 明日の予定"
};

// 選択中テンプレート
let selectedTemplate = null; // string | null
```

### データフォーマット
- **日付形式**: YYYY/MM/DD（例: 2025/01/15）
- **テンプレートキー**: 文字列（ユーザー入力）
- **テンプレート内容**: 文字列（改行コード含む）

## エラーハンドリング方針

### エラー分類
1. **ユーザー操作エラー**: 入力値不正、未選択状態での操作
2. **システムエラー**: ローカルストレージ制限、ブラウザ互換性
3. **データエラー**: JSON解析失敗、データ破損

### エラー対応
```javascript
// 入力値チェック
if (!name) {
    alert('テンプレート名を入力してください');
    return;
}

// ローカルストレージ例外処理
try {
    localStorage.setItem('memoAppTemplates', JSON.stringify(templates));
} catch (error) {
    alert('データの保存に失敗しました: ' + error.message);
}

// データ読み込み例外処理
try {
    templates = JSON.parse(saved);
} catch (error) {
    templates = {};
    console.error('テンプレートデータの読み込みに失敗:', error);
}
```

## ログ・監視方針

### ログ出力
- **エラーログ**: `console.error()` でブラウザコンソールに出力
- **操作ログ**: 重要操作完了時に `alert()` でユーザーに通知
- **デバッグログ**: 開発時のみ `console.log()` を使用

### 監視対象
- ローカルストレージ使用量
- テンプレート数の上限
- ブラウザ互換性問題

## セキュリティ方針

### データ保護
- **データスコープ**: 同一オリジン内のみアクセス可能
- **外部通信**: 一切行わない（オフライン完結）
- **入力値検証**: XSS対策として特殊文字のエスケープ不要（DOM操作でtextContent使用）

### セキュリティ制約
- **第三者アクセス**: ローカルストレージは同一オリジンからのみアクセス可能
- **データ漏洩**: ネットワーク送信なし
- **コード改ざん**: 単一ファイルのため改ざん検出容易

## 非機能要件への対応

### 性能要件
- **初期化時間**: DOM構築後の `init()` 実行で3秒以内
- **操作レスポンス**: ボタンクリックから画面更新まで1秒以内
- **メモリ使用量**: テンプレートデータのメモリ保持のみ

### 可用性要件
- **ブラウザ対応**: ES6対応ブラウザ（2015年以降）
- **オフライン動作**: 完全オフライン対応
- **エラー復旧**: ページリロードで状態復旧

### 保守性要件
- **コード構造**: 関数単位での責務分離
- **命名規約**: 日本語コメントと分かりやすい関数名
- **依存関係**: 外部ライブラリゼロ

### アクセシビリティ要件
- **視覚的配慮**:
  - WCAG 2.1 AA準拠のコントラスト比（4.5:1以上）
  - 最小フォントサイズ16px以上
  - 色に依存しない情報伝達
- **操作性配慮**:
  - タッチターゲット最小48px四方
  - キーボード操作対応（Tab、Enter、Space）
  - 適切なフォーカス管理
- **認知負荷軽減**:
  - シンプルで一貫したレイアウト
  - 明確な操作フィードバック
  - 誤操作を防ぐ確認ダイアログ
- **高齢者特有の配慮**:
  - 画面上部に重要な機能を配置
  - 長時間使用に適した低負荷な配色
  - 分かりやすい日本語ラベル